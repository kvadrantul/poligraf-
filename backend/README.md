# Poligraf Backend (Go)

Backend —Å–µ—Ä–≤–µ—Ä –¥–ª—è Poligraf Mini App, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ Go.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd backend
go mod download
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ `.env.example`):

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ API –∫–ª—é—á–∏:
```bash
V0_API_KEY=your_v0_api_key_here
```

### 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
go run main.go
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:8080`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
backend/
‚îú‚îÄ‚îÄ main.go              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îî‚îÄ‚îÄ generate.go      # Handler –¥–ª—è /api/generate
‚îú‚îÄ‚îÄ go.mod               # Go –º–æ–¥—É–ª—å
‚îú‚îÄ‚îÄ .env.example         # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîß API Endpoints

### POST /api/generate

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥ —á–µ—Ä–µ–∑ v0.dev API (–∏–ª–∏ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã).

**Request:**
```json
{
  "userPrompt": "–°–æ–∑–¥–∞–π –≤–∏–∑–∏—Ç–∫—É...",
  "image": "data:image/jpeg;base64,..." (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ),
  "provider": "v0" | "lovable"
}
```

**Response:**
```json
{
  "result": "export default function...",
  "code": "export default function...",
  "provider": "v0.dev"
}
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å–∫ —Å hot reload (—Ç—Ä–µ–±—É–µ—Ç air)
air

# –ò–ª–∏ –æ–±—ã—á–Ω—ã–π –∑–∞–ø—É—Å–∫
go run main.go
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ air –¥–ª—è hot reload

```bash
go install github.com/cosmtrek/air@latest
```

–°–æ–∑–¥–∞–π—Ç–µ `.air.toml` –≤ –∫–æ—Ä–Ω–µ backend (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

## üì¶ –î–µ–ø–ª–æ–π

### Docker

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t poligraf-backend .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -p 8080:8080 --env-file .env poligraf-backend
```

### Railway / Render / Fly.io

–ü—Ä–æ—Å—Ç–æ –∑–∞–¥–µ–ø–ª–æ–π—Ç–µ –ø–∞–ø–∫—É `backend/` —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞:
```bash
go run main.go
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Dockerfile.

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `V0_API_KEY` - API –∫–ª—é—á v0.dev (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `LOVABLE_API_KEY` - API –∫–ª—é—á Lovable (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `OPENAI_API_KEY` - API –∫–ª—é—á OpenAI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è fallback)
- `PORT` - –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8080)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
go test ./...

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
go test -cover ./...
```

## üìù TODO

- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É Lovable API
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –ë–î
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (structured logging)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting



