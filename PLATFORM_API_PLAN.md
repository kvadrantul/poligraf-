# План интеграции с v0 Platform API

## Предлагаемая архитектура

### Вариант: Один проект на пользователя (рекомендуется)

**Логика:**
1. **Идентификация:** Используем Telegram User ID (`tg.initDataUnsafe.user.id`)
2. **Хранение:** localStorage (простая версия) или Backend БД (продвинутая)
3. **Проекты:** Один проект на пользователя
4. **Чаты:** Один чат в проекте для всех итераций

### Преимущества:
- ✅ Каждый пользователь видит только свои генерации
- ✅ Можно итерировать в рамках одного проекта
- ✅ Проекты сохраняются в аккаунте v0.dev
- ✅ Можно открыть проект в веб-интерфейсе v0.dev

### Недостатки:
- ❌ Нужно управлять проектами (создание, поиск)
- ❌ Если много пользователей - много проектов (нужно проверить лимиты)

## Альтернатива: Один общий проект

Если есть лимиты на проекты:
- Один проект для всех пользователей
- Разделение по чатам (один чат = один пользователь)
- Или один чат с идентификацией пользователя в промпте

## Реализация (Фаза 1: localStorage)

### Шаг 1: Получение User ID
```javascript
const userId = tg.initDataUnsafe?.user?.id;
```

### Шаг 2: Проверка существующего проекта
```javascript
const stored = localStorage.getItem(`v0-project-${userId}`);
if (stored) {
  const { projectId, chatId } = JSON.parse(stored);
  // Используем существующий проект
} else {
  // Создаем новый проект
}
```

### Шаг 3: Создание проекта (через backend)
```javascript
POST /api/v0/create-project
Body: { userId }
Response: { projectId, chatId }
```

### Шаг 4: Итерация в чате
```javascript
POST /api/v0/iterate
Body: { projectId, chatId, prompt }
Response: { code }
```

## Endpoints для backend

1. **POST /api/v0/create-project**
   - Создает проект в v0.dev
   - Создает чат в проекте
   - Возвращает projectId и chatId

2. **POST /api/v0/iterate**
   - Отправляет промпт в существующий чат
   - Возвращает обновленный компонент

3. **GET /api/v0/project/{userId}** (опционально)
   - Получает projectId и chatId для пользователя
   - Если нет - создает новый

## Лимиты (нужно проверить)

Перед реализацией нужно узнать:
- Сколько проектов можно создать?
- Сколько чатов в проекте?
- Сколько сообщений в чате?
- Rate limits API?

## Следующий шаг

Хотите, чтобы я:
1. Изучил документацию v0 Platform API
2. Реализовал создание проекта и итерации
3. Добавил хранение в localStorage

Или сначала проверим лимиты и документацию?



